var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,h,f){b!=Array.prototype&&b!=Object.prototype&&(b[h]=f.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(h){return $jscomp.SYMBOL_PREFIX+(h||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var h=0;return $jscomp.iteratorPrototype(function(){return h<b.length?{done:!1,value:b[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var h=b[Symbol.iterator];return h?h.call(b):$jscomp.arrayIterator(b)};$jscomp.arrayFromIterator=function(b){for(var h,f=[];!(h=b.next()).done;)f.push(h.value);return f};$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};
$jscomp.checkStringArgs=function(b,h,f){if(null==b)throw new TypeError("The 'this' value for String.prototype."+f+" must not be null or undefined");if(h instanceof RegExp)throw new TypeError("First argument to String.prototype."+f+" must not be a regular expression");return b+""};
$jscomp.polyfill=function(b,h,f,d){if(h){f=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in f||(f[e]={});f=f[e]}b=b[b.length-1];d=f[b];h=h(d);h!=d&&null!=h&&$jscomp.defineProperty(f,b,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(b,f){var d=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===f&&(f=d.length);f=Math.max(0,Math.min(f|0,d.length));for(var e=b.length;0<e&&0<f;)if(d[--f]!=b[--e])return!1;return 0>=e}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},h=Object.create(new $jscomp.global.Proxy(b,{get:function(f,d,e){return f==b&&"q"==d&&e==h}}));return!0===h.q}catch(f){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(b,h){return Object.prototype.hasOwnProperty.call(b,h)};
$jscomp.polyfill("WeakMap",function(b){function h(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),l=new b([[a,2],[c,3]]);if(2!=l.get(a)||3!=l.get(c))return!1;l.delete(a);l.set(c,4);return!l.has(a)&&4==l.get(c)}catch(n){return!1}}function f(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function d(a){var c=Object[a];c&&(Object[a]=function(a){f(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(h())return b;
var e="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var a=0,c=function(c){this.id_=(a+=Math.random()+1).toString();if(c){$jscomp.initSymbol();$jscomp.initSymbolIterator();c=$jscomp.makeIterator(c);for(var g;!(g=c.next()).done;)g=g.value,this.set(g[0],g[1])}};c.prototype.set=function(a,c){f(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=c;return this};c.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};c.prototype.has=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};c.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return c},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function h(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var k=c.entries(),d=k.next();if(d.done||d.value[0]!=a||"s"!=d.value[1])return!1;d=k.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!k.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(h())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=new WeakMap,d=function(a){this.data_={};this.head_=c();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var g;!(g=a.next()).done;)g=g.value,this.set(g[0],g[1])}};d.prototype.set=function(a,c){var g=e(this,a);g.list||(g.list=this.data_[g.id]=[]);g.entry?g.entry.value=c:(g.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:c},g.list.push(g.entry),this.head_.previous.next=g.entry,this.head_.previous=g.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=c();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return a(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return a(this,function(a){return a.key})};d.prototype.values=function(){return a(this,function(a){return a.value})};d.prototype.forEach=function(a,c){for(var b=this.entries(),k;!(k=b.next()).done;)k=k.value,a.call(c,k[1],k[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,c){var b=c&&typeof c;"object"==
b||"function"==b?f.has(c)?b=f.get(c):(b=""+ ++k,f.set(c,b)):b="p_"+c;var g=a.data_[b];if(g&&$jscomp.owns(a.data_,b))for(a=0;a<g.length;a++){var d=g[a];if(c!==c&&d.key!==d.key||c===d.key)return{id:b,list:g,index:a,entry:d}}return{id:b,list:g,index:-1,entry:void 0}},a=function(a,c){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:c(b)};b=null}return{done:!0,value:void 0}})},c=function(){var a={};return a.previous=
a.next=a.head=a},k=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(b){function h(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),e=new b($jscomp.makeIterator([d]));if(!e.has(d)||1!=e.size||e.add(d)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var a=e.entries(),c=a.next();if(c.done||c.value[0]!=d||c.value[1]!=d)return!1;c=a.next();return c.done||c.value[0]==d||4!=c.value[0].x||c.value[1]!=c.value[0]?!1:a.next().done}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(h())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var d;!(d=b.next()).done;)this.add(d.value)}this.size=this.map_.size};f.prototype.add=function(b){this.map_.set(b,b);this.size=this.map_.size;return this};f.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};f.prototype.clear=function(){this.map_.clear();
this.size=0};f.prototype.has=function(b){return this.map_.has(b)};f.prototype.entries=function(){return this.map_.entries()};f.prototype.values=function(){return this.map_.values()};f.prototype.keys=f.prototype.values;f.prototype[Symbol.iterator]=f.prototype.values;f.prototype.forEach=function(b,e){var a=this;this.map_.forEach(function(c){return b.call(e,c,c,a)})};return f},"es6","es3");
$jscomp.polyfill("Array.from",function(b){return b?b:function(b,f,d){$jscomp.initSymbolIterator();f=null!=f?f:function(a){return a};var e=[],a=b[Symbol.iterator];if("function"==typeof a)for(b=a.call(b);!(a=b.next()).done;)e.push(f.call(d,a.value));else{a=b.length;for(var c=0;c<a;c++)e.push(f.call(d,b[c]))}return e}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(b,f){var d=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var e=d.length,a=b.length;f=Math.max(0,Math.min(f|0,d.length));for(var c=0;c<a&&f<e;)if(d[f++]!=b[c++])return!1;return c>=a}},"es6","es3");$jscomp.findInternal=function(b,h,f){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var a=b[e];if(h.call(f,a,e,b))return{i:e,v:a}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,f){return $jscomp.findInternal(this,b,f).v}},"es6","es3");$jscomp.iteratorFromArray=function(b,h){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var f=0,d={next:function(){if(f<b.length){var e=f++;return{value:h(e,b[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");$jscomp.polyfill("Object.values",function(b){return b?b:function(b){var f=[],d;for(d in b)$jscomp.owns(b,d)&&f.push(b[d]);return f}},"es8","es3");var JGPortal={};
(function(){var b={debug:function(a){console&&console.debug&&console.debug(a)},info:function(a){console&&console.info&&console.info(a)},warn:function(a){console&&console.warn&&console.warn(a)},error:function(a){console&&console.error&&console.error(a)}};JGPortal.log=b;var h=function(a){this._debugHandler=!1;this._portal=a;this._ws=null;this._sendQueue=[];this._recvQueue=[];this._recvQueueLocks=0;this._messageHandlers={};this._refreshTimer=null;this._inactivity=0;this._reconnectTimer=null;this._connectRequested=
!1;this._initialConnect=!0;this._portalSessionId=null;this._connectionLost=!1;this._oldPortalSessionId=sessionStorage.getItem("org.jgrapes.portal.base.sessionId")};h.prototype.portalSessionId=function(){return this._portalSessionId};h.prototype._connect=function(){var a=("https:"===window.location.protocol?"wss":"ws")+"://"+window.location.host+window.location.pathname;a.endsWith("/")||(a+="/");this._portalSessionId=sessionStorage.getItem("org.jgrapes.portal.base.sessionId");a+="portal-session/"+
this._portalSessionId;this._oldPortalSessionId&&(a+="?was="+this._oldPortalSessionId,this._oldPortalSessionId=null);b.debug("Creating WebSocket for "+a);this._ws=new WebSocket(a);b.debug("Created WebSocket with readyState "+this._ws.readyState);var c=this;this._ws.onopen=function(){b.debug("OnOpen called for WebSocket.");c._connectionLost&&(c._connectionLost=!1,c._portal.connectionRestored());c._drainSendQueue();if(c._initialConnect)c._initialConnect=!1;else{var a=c._portal._renderer;a.findPreviewIds().forEach(function(c){a.sendRenderPortlet(c,
["Preview"])});a.findViewIds().forEach(function(c){a.sendRenderPortlet(c,["View"])})}c._refreshTimer=setInterval(function(){0==c._sendQueue.length&&(c._inactivity+=c._portal.sessionRefreshInterval,0<c._portal.sessionInactivityTimeout&&c._inactivity>=c._portal.sessionInactivityTimeout?(c.close(),c._portal.connectionSuspended(function(){c.connect()})):c._send({jsonrpc:"2.0",method:"keepAlive",params:[]}))},c._portal.sessionRefreshInterval)};this._ws.onclose=function(a){b.debug("OnClose called for WebSocket (reconnect: "+
c._connectRequested+").");null!==c._refreshTimer&&(clearInterval(c._refreshTimer),c._refreshTimer=null);c._connectRequested&&(c._connectionLost||(c._portal.connectionLost(),c._connectionLost=!0),c._initiateReconnect())};this._ws.onmessage=function(a){try{var k=JSON.parse(a.data)}catch(l){b.error(l.name+":"+l.lineNumber+":"+l.columnNumber+": "+l.message+". Data: ");b.error(a.data);return}c._recvQueue.push(k);1===c._recvQueue.length&&c._handleMessages()}};h.prototype.connect=function(){this._connectRequested=
!0;var a=this;$(window).on("beforeunload",function(){b.debug("Closing WebSocket due to page unload");a._connectRequested=!1;a._ws.close()});this._connect()};h.prototype.close=function(){this._portalSessionId&&this._send({jsonrpc:"2.0",method:"disconnect",params:[this._portalSessionId]});this._connectRequested=!1;this._ws.close()};h.prototype._initiateReconnect=function(){if(!this._reconnectTimer){var a=this;this._reconnectTimer=setTimeout(function(){a._reconnectTimer=null;a._connect()},1E3)}};h.prototype._drainSendQueue=
function(){for(;this._ws.readyState==this._ws.OPEN&&0<this._sendQueue.length;){var a=this._sendQueue[0];try{this._ws.send(a),this._sendQueue.shift()}catch(c){b.warn(c)}}};h.prototype._send=function(a){this._sendQueue.push(JSON.stringify(a));this._drainSendQueue()};h.prototype.send=function(a){this._inactivity=0;this._send(a)};h.prototype.addMessageHandler=function(a,c){this._messageHandlers[a]=c};h.prototype._handlerLog=function(a){this._debugHandler&&b.debug(a())};h.prototype._handleMessages=function(){for(;;){if(0<
this._recvQueueLocks){this._handlerLog(function(){return"Handler receive queue locked."});break}if(0===this._recvQueue.length){this._handlerLog(function(){return"Handler receive queue empty."});break}var a=this._recvQueue.shift(),c=this._messageHandlers[a.method];c?a.hasOwnProperty("params")?(this._handlerLog(function(){return"Handling: "+a.method+"["+a.params+"]"}),c.apply(null,[].concat($jscomp.arrayFromIterable(a.params)))):(this._handlerLog(function(){return"Handling: "+a.method}),c()):b.error("No handler for invoked method "+
a.method)}};h.prototype.lockMessageReceiver=function(){this._recvQueueLocks+=1;if(this._debugHandler)try{throw Error("Lock");}catch(a){b.debug("Locking receiver:\n"+a.stack)}};h.prototype.unlockMessageReceiver=function(){--this._recvQueueLocks;if(this._debugHandler)try{throw Error("Unlock");}catch(a){b.debug("Unlocking receiver:\n"+a.stack)}0==this._recvQueueLocks&&this._handleMessages()};var f=function(a){this._portal=a;this._debugLoading=!1;this._providedScriptResources=new Set;this._unresolvedScriptRequests=
[];this._loadingScripts=new Set;this._unlockMessageQueueAfterLoad=!1;this._loadingTimeoutHandler=null;this._scriptResourceSnippet=0};f.prototype._loadingMsg=function(a){this._debugLoading&&b.debug(moment().format("HH:mm:ss.SSS")+": "+a())};f.prototype._mayBeStartScriptLoad=function(a){var c=this;c._debugLoading&&(a.id=0<a.provides.length?a.provides.join("/"):a.uri?a.uri:"Snippet_"+ ++this._scriptResourceSnippet);var b=a.requires;a.requires=[];b.forEach(function(b){c._providedScriptResources.has(b)||
a.requires.push(b)});0<a.requires.length?(c._loadingMsg(function(){return"Not (yet) loading: "+a.id+", missing: "+a.requires.join(", ")}),c._unresolvedScriptRequests.push(a)):this._startScriptLoad(a)};f.prototype._startScriptLoad=function(a){var c=this,k=$("head").get()[0],g=document.createElement("script");a.id&&g.setAttribute("id",a.id);a.type&&g.setAttribute("type",a.type);a.source?(g.text=a.source,k.appendChild(g),c._scriptResourceLoaded(a)):(g.src=a.uri,g.addEventListener("load",function(b){c._loadingScripts.delete(g.src);
c._scriptResourceLoaded(a)}),c._loadingMsg(function(){return"Loading: "+a.id}),c._loadingScripts.add(g.src),null===this._loadingTimeoutHandler&&(this._loadingTimeoutHandler=setInterval(function(){b.warn("Still waiting for: "+Array.from(c._loadingScripts).join(", "))},5E3)),k.appendChild(g))};f.prototype._scriptResourceLoaded=function(a){var c=this;this._loadingMsg(function(){return"Loaded: "+a.id});a.provides.forEach(function(a){c._providedScriptResources.add(a)});var b=new Set(a.provides),g=c._unresolvedScriptRequests;
c._unresolvedScriptRequests=[];g.forEach(function(a){var k=a.requires;a.requires=[];k.forEach(function(c){b.has(c)||a.requires.push(c)});0==a.requires.length?c._startScriptLoad(a):c._unresolvedScriptRequests.push(a)});0==c._loadingScripts.size&&(null!==this._loadingTimeoutHandler&&(clearInterval(this._loadingTimeoutHandler),this._loadingTimeoutHandler=null),c._unlockMessageQueueAfterLoad&&(c._loadingMsg(function(){return"All loaded, unlocking message queue."}),c._portal.unlockMessageQueue()))};f.prototype.addPageResources=
function(a,c,b){for(var k in a){var d=a[k];0===$("head > link[href='"+d+"']").length&&$("head link[rel='stylesheet']:last").after("<link rel='stylesheet' href='"+d+"'>")}c&&(a=$("style"),a.text(c),$("head link[rel='stylesheet']:last").after(a));for(var e in b)c=b[e],c.uri&&0<$("head > script[src='"+c.uri+"']").length||this._mayBeStartScriptLoad(c)};f.prototype.lockWhileLoading=function(){0<this._loadingScripts.size&&!this._unlockMessageQueueAfterLoad&&(this._portal.lockMessageQueue(),this._loadingMsg(function(){return"Locking message queue until all loaded."}),
this._unlockMessageQueueAfterLoad=!0)};JGPortal.Renderer=function(){};JGPortal.Renderer.prototype.init=function(){};JGPortal.Renderer.prototype.connectionLost=function(){b.warn("Not implemented!")};JGPortal.Renderer.prototype.connectionRestored=function(){b.warn("Not implemented!")};JGPortal.Renderer.prototype.connectionSuspended=function(a){b.warn("Not implemented!")};JGPortal.Renderer.prototype.portalConfigured=function(){b.warn("Not implemented!")};JGPortal.Renderer.prototype.addPortletType=function(a,
c,k){b.warn("Not implemented!")};JGPortal.Renderer.prototype.lastPortalLayout=function(a,c,k){b.warn("Not implemented!")};JGPortal.Renderer.prototype.updatePortletPreview=function(a,c,k,g,d){b.warn("Not implemented!")};JGPortal.Renderer.prototype.updatePortletView=function(a,c,k,g,d){b.warn("Not implemented!")};JGPortal.Renderer.prototype.portletRemoved=function(a){b.warn("Not implemented!")};JGPortal.Renderer.prototype.updatePortletTitle=function(a,c){b.warn("Not implemented!")};JGPortal.Renderer.prototype.updatePortletModes=
function(a,c){b.warn("Not implemented!")};JGPortal.Renderer.prototype.showEditDialog=function(a,c,k){b.warn("Not implemented!")};JGPortal.Renderer.prototype.notification=function(a,c){b.warn("Not implemented!")};JGPortal.Renderer.prototype.sendSetLocale=function(a){e.send("setLocale",a)};JGPortal.Renderer.prototype.sendRenderPortlet=function(a,c){e.send("renderPortlet",a,c)};JGPortal.Renderer.prototype.sendAddPortlet=function(a,c){e.send("addPortlet",a,c)};JGPortal.Renderer.prototype.sendDeletePortlet=
function(a){e.send("deletePortlet",a)};JGPortal.Renderer.prototype.sendLayout=function(a,c,b){e.isConfigured&&e.send("portalLayout",a,c,b)};JGPortal.Renderer.prototype.send=function(a,c){for(var b=[],g=1;g<arguments.length;++g)b[g-1]=arguments[g];e.send.apply(e,[].concat([a],$jscomp.arrayFromIterable(b)))};JGPortal.Renderer.prototype.findPortletRepresentations=function(a){return $(".portlet[data-portlet-id='"+a+"']").get()};JGPortal.Renderer.prototype.findPortletPreview=function(a){a=$(".portlet-preview[data-portlet-id='"+
a+"']");return 1===a.length?$(a[0]):null};JGPortal.Renderer.prototype.findPreviewIds=function(){return $(".portlet-preview[data-portlet-id]").map(function(){return $(this).attr("data-portlet-id")}).get()};JGPortal.Renderer.prototype.findPortletView=function(a){a=$(".portlet-view[data-portlet-id='"+a+"']");return 1===a.length?$(a[0]):null};JGPortal.Renderer.prototype.findViewIds=function(){return $(".portlet-view[data-portlet-id]").map(function(){return $(this).attr("data-portlet-id")}).get()};JGPortal.Renderer.prototype.formatMemorySize=
function(a,c,b){void 0===b&&(b=c,c=-1);for(var k=0;1E4<a&&5>k;)a/=1024,k+=1;var d="PiB";switch(k){case 0:d="B";break;case 1:d="kiB";break;case 2:d="MiB";break;case 3:d="GiB";break;case 4:d="TiB"}return 0<=c?(new Intl.NumberFormat(b,{minimumFractionDigits:c,maximumFractionDigits:c})).format(a)+" "+d:(new Intl.NumberFormat(b)).format(a)+" "+d};var d=function(){var a=this;this._isConfigured=!1;this._sessionInactivityTimeout=this._sessionRefreshInterval=0;this._renderer=null;this._webSocket=new h(this);
this._portletFunctionRegistry={};this._previewTemplate=$('<section class="portlet portlet-preview"></section>');this._viewTemplate=$('<article class="portlet portlet-view"></article>');this._editTemplate=$('<div class="portlet portlet-edit"></div>');this._resourceManager=new f(this);this._webSocket.addMessageHandler("addPageResources",function(c,b,g){a._resourceManager.addPageResources(c,b,g)});this._webSocket.addMessageHandler("addPortletType",function(c,b,g,d,e){a._resourceManager.addPageResources(g,
null,d);a._renderer.addPortletType(c,b,e)});this._webSocket.addMessageHandler("lastPortalLayout",function(c,b,d){a._resourceManager.lockWhileLoading();a._renderer.lastPortalLayout(c,b,d)});this._webSocket.addMessageHandler("notifyPortletView",function(c,b,d,e){(c=a._portletFunctionRegistry[c])&&(d=c[d])&&d(b,e)});this._webSocket.addMessageHandler("portalConfigured",function(){a._isConfigured=!0;a._renderer.portalConfigured()});this._webSocket.addMessageHandler("updatePortlet",function(c,b,d,e,f){"Preview"===
b||"DeleteablePreview"===b?a._updatePreview(c,d,b,e,f):"View"===b?a._updateView(c,d,e,f):"Edit"===b&&(b=a._editTemplate.clone(),b.attr("data-portlet-id",c),a._renderer.showEditDialog(b,d,e),a._execOnLoad(b))});this._webSocket.addMessageHandler("deletePortlet",function(c){c=a._renderer.findPortletRepresentations(c);0<c.length&&a._renderer.portletRemoved(c)});this._webSocket.addMessageHandler("displayNotification",function(c,b){a._renderer.notification(c,b)});this._webSocket.addMessageHandler("retrieveLocalData",
function(c){var d=[];try{for(var g=0;g<localStorage.length;g++){var e=localStorage.key(g);if(!c.endsWith("/")){if(e!==c)continue}else if(!e.startsWith(c))continue;var f=localStorage.getItem(e);d.push([e,f])}}catch(m){b.error(m)}a._webSocket.send({jsonrpc:"2.0",method:"retrievedLocalData",params:[d]})});this._webSocket.addMessageHandler("storeLocalData",function(a){try{for(var c in a){var d=a[c];"u"===d[0]?localStorage.setItem(d[1],d[2]):"d"===d[0]&&localStorage.removeItem(d[1])}}catch(l){b.error(l)}});
this._webSocket.addMessageHandler("reload",function(){window.location.reload(!0)})};d.prototype.init=function(a,c,b,d){sessionStorage.setItem("org.jgrapes.portal.base.sessionId",a);this._sessionRefreshInterval=c;this._sessionInactivityTimeout=b;this._renderer=d;JGPortal.renderer=d;this._webSocket.connect();this._renderer.init();this.send("portalReady")};d.prototype.connectionLost=function(){this._renderer.connectionLost()};d.prototype.connectionRestored=function(){this._renderer.connectionRestored()};
d.prototype.connectionSuspended=function(a){this._renderer.connectionSuspended(a)};d.prototype.lockMessageQueue=function(){this._webSocket.lockMessageReceiver()};d.prototype.unlockMessageQueue=function(){this._webSocket.unlockMessageReceiver()};d.prototype._execOnLoad=function(a){a.find("[data-on-load]").each(function(){for(var a=$(this).data("onLoad").split("."),b=window;b&&0<a.length;)b=b[a.shift()];b&&"function"===typeof b&&b.apply(null,[$(this)])})};d.prototype._updatePreview=function(a,b,d,e,
f){var c=this._renderer.findPortletPreview(a),k=!c;k&&(c=this._previewTemplate.clone(),c.attr("data-portlet-id",a));"DeleteablePreview"===d?c.addClass("portlet-deleteable"):c.removeClass("portlet-deleteable");this._renderer.updatePortletPreview(k,c,b,e,f);this._execOnLoad(c)};d.prototype._updateView=function(a,b,d,e){var c=this._renderer.findPortletView(a),k=!c;k&&(c=this._viewTemplate.clone(),c.attr("data-portlet-id",a));this._renderer.updatePortletView(k,c,b,d,e);this._execOnLoad(c)};d.prototype.registerPortletMethod=
function(a,c,b){var d=this._portletFunctionRegistry[a];d||(d={},this._portletFunctionRegistry[a]=d);d[c]=b};d.prototype.send=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];0<c.length?this._webSocket.send({jsonrpc:"2.0",method:a,params:c}):this._webSocket.send({jsonrpc:"2.0",method:a})};d.prototype.notifyPortletModel=function(a,c,b){for(var d=[],f=2;f<arguments.length;++f)d[f-2]=arguments[f];void 0===d?e.send("notifyPortletModel",a,c):e.send("notifyPortletModel",a,c,d)};
d.prototype.generateUUID=function(){var a=crypto.getRandomValues(new Uint8Array(16));a[6]=a[6]&15|64;a[8]=a[8]&63|128;return a[0].toString(16)+a[1].toString(16)+a[2].toString(16)+a[3].toString(16)+"-"+a[4].toString(16)+a[5].toString(16)+"-"+a[6].toString(16)+a[7].toString(16)+"-"+a[8].toString(16)+a[9].toString(16)+"-"+a[0].toString(10)+a[0].toString(11)+a[0].toString(12)+a[0].toString(13)+a[0].toString(14)+a[0].toString(15)};$jscomp.global.Object.defineProperties(d.prototype,{isConfigured:{configurable:!0,
enumerable:!0,get:function(){return this._isConfigured}},sessionRefreshInterval:{configurable:!0,enumerable:!0,get:function(){return this._sessionRefreshInterval}},sessionInactivityTimeout:{configurable:!0,enumerable:!0,get:function(){return this._sessionInactivityTimeout}},renderer:{configurable:!0,enumerable:!0,get:function(){return this._renderer}}});var e=new d;JGPortal.init=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];e.init.apply(e,[].concat($jscomp.arrayFromIterable(b)))};
JGPortal.registerPortletMethod=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];e.registerPortletMethod.apply(e,[].concat($jscomp.arrayFromIterable(b)))};JGPortal.notifyPortletModel=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return e.notifyPortletModel.apply(e,[].concat($jscomp.arrayFromIterable(b)))};JGPortal.lockMessageQueue=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];e.lockMessageQueue.apply(e,[].concat($jscomp.arrayFromIterable(b)))};
JGPortal.unlockMessageQueue=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];e.unlockMessageQueue.apply(e,[].concat($jscomp.arrayFromIterable(b)))};JGPortal.findPortletPreview=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return e.renderer.findPortletPreview.apply(e.renderer,[].concat($jscomp.arrayFromIterable(b)))};JGPortal.findPortletView=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return e.renderer.findPortletView.apply(e.renderer,
[].concat($jscomp.arrayFromIterable(b)))};JGPortal.createIfMissing=function(a,b,d){var c=a.data(b);if(c)return c;c=d();a.data(b,c);return c};JGPortal.TableController=function(a,b){this.keys=[];this.labelsByKey={};for(var c in a)this.keys.push(a[c][0]),this.labelsByKey[a[c][0]]=a[c][1];this.sortKey="";this.sortOrders={};for(var d in this.keys)this.sortOrders[this.keys[d]]=1;this.filterKey="";b&&("sortKey"in b&&this.sortBy(b.sortKey),"sortOrder"in b&&this.sortBy(this.sortKey,b.sortOrder))};JGPortal.TableController.prototype.label=
function(a){return this.labelsByKey[a]};JGPortal.TableController.prototype.sortOrder=function(a){return this.sortOrders[a]};JGPortal.TableController.prototype.sortBy=function(a,b){this.sortKey!=a?this.sortKey=a:this.sortOrders[a]*=-1;"undefined"!==typeof b&&("up"===b&&(this.sortOrders[a]=1),"down"===b&&(this.sortOrders[a]=-1))};JGPortal.TableController.prototype.sortedByAsc=function(a){return this.sortKey==a&&1==this.sortOrders[a]};JGPortal.TableController.prototype.sortedByDesc=function(a){return this.sortKey==
a&&-1==this.sortOrders[a]};JGPortal.TableController.prototype.filter=function(a){var b=this.filterKey&&this.filterKey.toLowerCase();b&&(a=a.filter(function(a){return Object.values(a).some(function(a){return-1<String(a).toLowerCase().indexOf(b)})}));if(this.sortKey){var d=this.sortKey,e=this.sortOrders[d];a=a.sort(function(a,b){a=a[d];b=b[d];return(a===b?0:a>b?1:-1)*e})}return a};JGPortal.TableController.prototype.filterBy=function(a){this.filterKey=a};JGPortal.TableController.prototype.updateFilter=
function(a){this.filterKey=$(a.target).val()};JGPortal.TableController.prototype.clearFilter=function(a){$(a.target).closest("form").find("input").val("");this.filterKey=""};JGPortal.TableController.prototype.breakBeforeDots=function(a){return String(a).replace(/\./g,"&#x200b;.")}})();
//# sourceMappingURL=functions.min.js.map
